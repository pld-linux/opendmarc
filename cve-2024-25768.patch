From: =?utf-8?q?David_B=C3=BCrgin?= <dbuergin@gluet.ch>
Date: Thu, 23 May 2024 17:35:20 +0200
Subject: Fix null pointer dereference in opendmarc_policy.c (CVE-2024-25768)

Bug: https://github.com/trusteddomainproject/OpenDMARC/issues/256
---
 libopendmarc/opendmarc_policy.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/libopendmarc/opendmarc_policy.c b/libopendmarc/opendmarc_policy.c
index c864906..35b23c1 100644
--- a/libopendmarc/opendmarc_policy.c
+++ b/libopendmarc/opendmarc_policy.c
@@ -1475,7 +1475,7 @@ opendmarc_policy_fetch_ruf(DMARC_POLICY_T *pctx, u_char *list_buf, size_t size_o
 	{
 		return NULL;
 	}
-	if (list_buf != NULL || size_of_buf > 0)
+	if (list_buf != NULL && size_of_buf > 0)
 	{
 		(void) memset(list_buf, '\0', size_of_buf);
 		sp = list_buf;
